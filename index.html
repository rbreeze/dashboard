<html>
<head>
<title>Health Data- Remington Breeze</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="stylesheet" href="style.css" type="text/css">
</head>

<body>

	<h1 class="header">
		<a href="http://rbreeze.github.io/" target="_blank">Remington Breeze</a>
	</h1>

	<div class="navigation">
		<a class="back button">Back</a>
		<a class="forward button">Forward</a>
		<a class="week button">Week View</a>
		<a class="month button">Month View</a>
      <a class="year button">Year View</a>
	</div>

	<div class="mileage container">
		<h1>Miles- <span class="whichWeek">This Week</span></h1>
		<canvas id="mileage" class="canvas"></canvas>
	</div>

   <div class="pace container">
      <h1>Paces- <span class="whichWeek">This Week</span></h1>
      <canvas id="pace" class="canvas"></canvas>
   </div>

	<div class="sleep container">
		<h1>Sleep- <span class="whichWeek">This Week</span></h1>
		<canvas id="sleep" class="canvas"></canvas>
	</div>

	<div class="water container">
		<h1>Water- <span class="whichWeek">This Week</span></h1>
		<canvas id="water" class="canvas"></canvas>
	</div>

	<div class="carbs container">
		<h1>Carbs &amp; Sugar- <span class="whichWeek">This Week</span></h1>
		<canvas id="carbs" class="canvas"></canvas>
	</div>

	<div class="fat container">
		<h1>Fat &amp; SatFat- <span class="whichWeek">This Week</span></h1>
		<canvas id="fat" class="canvas"></canvas>
	</div>

	<div class="protein container">
		<h1>Protein- <span class="whichWeek">This Week</span></h1>
		<canvas id="protein" class="canvas"></canvas>
	</div>

	<div class="calories container">
		<h1>Calories- <span class="whichWeek">This Week</span></h1>
		<canvas id="calories" class="canvas"></canvas>
	</div>

   <div class="avgMacronutrients container noYear">
      <h1>Macronutrient Percentages- <span class="doughnutTime">Last Week</span></h1>
      <canvas id="avgMacronutrients" class="canvas noYear"></canvas>
   </div>

	<div class="avgValues container noYear">
		<h1> All Time Averages </h1>
		<table>
			<tr>
				<td class="left">Sleep</td>
				<td id="avgSleep"></td>
			</tr>
			<tr>
				<td class="left">Sugar</td>
				<td id="avgSugar"></td>
			</tr>
			<tr>
				<td class="left">Calories</td>
				<td id="avgCalories"></td>
			</tr>
			<tr>
				<td class="left">Mileage</td>
				<td id="avgMileage"></td>
			</tr>
			<tr>
				<td class="left">Pace</td>
				<td id="avgPace"></td>
			</tr>
		</table>
	</div>

   <div class="clear"></div>

	<script src="http://code.jquery.com/jquery-latest.min.js"></script>
	<script src="jquery-csv.min.js"></script>
	<script src="Chart.min.js"></script>
	<script src="chartData.js"></script>
	<script src="sheetCharts.js"></script>
    <script type="text/javascript">

      var state = "month";
      var timeBlock = 0; 
      var timeBlockLength = 18; 
      var chartOptions = {};
      
   $(document).ready(function() {
      var windowWidth = $(window).width();
      function checkWidth() {
         if (state == 'year' && windowWidth < 1000) {
            $('.month').trigger('click');
            updateGraphs();
         }
      }

      checkWidth();

      $(window).resize(checkWidth);
   
      $('.month').css('border', '2px solid #32BAF9');

         updateGraphs();

         $('.back').click(function() {
            timeBlock += 1;
            updateGraphs();
         });

         $('.forward').click(function() {
            timeBlock -= 1; 
            updateGraphs();
         });

         $('.year').click(function() {
            state = "year";
            $('.year').css('border', '2px solid #32BAF9');
            $('.month').css('border', '1px solid #BBBBBB');
            $('.week').css('border', '1px solid #BBBBBB');
            updateGraphs();
         });

         $('.month').click(function() {
            state = "month";
            $('.month').css('border', '2px solid #32BAF9');
            $('.week').css('border', '1px solid #BBBBBB');
            $('.year').css('border', '1px solid #BBBBBB');
            updateGraphs();
         });

         $('.week').click(function() {
            state = "week";
            $('.week').css('border', '2px solid #32BAF9');
            $('.month').css('border', '1px solid #BBBBBB');
            $('.year').css('border', '1px solid #BBBBBB');
            updateGraphs();
         });
         
   }); 

    function updateGraphs() {

      $('.canvas').each(function() {
         var parent = $(this).parent(); 
         var id = $(this).attr('id');
         this.remove();
         parent.append('<canvas class="canvas" id="' + id + '"></canvas>');
      });

      var id = '1VdT0ZqbmH0D2vQS4ZS0nxKGiJesd8vCLM21Bs0r9mxc';
      var defaultWidth = 500;
      var width;

      switch(state) {
         case 'month': 
            $('.container').removeClass('centered');
            timeBlockLength = 30;
            width = defaultWidth;
            break;
         case 'week':
            $('.container').removeClass('centered');
            timeBlockLength = 9;
            width = defaultWidth;
            break;
         case 'year':
            $('.container').addClass('centered');
            width = 1000;
            timeBlockLength = 75;
            break;
         default:
            timeBlockLength = 18;
            break;
      }

      $('.canvas').not('.noYear').css({ 'width' : width });
      $('.container').not('.noYear').css({ 'width' : width });
      $('.noYear').css({'width': defaultWidth});
      $('#avgMacronutrients').css({'width': defaultWidth});
      $('.noYear').removeClass('centered');

      $('#mileage').newLineFromSheet({
         color: 'red',
         id: id, 
         sheet: 'Mileage',
         valueColumn: 1,
         scaleOverride: true,
         stepWidth: 1.5,
         minValue: 0, 
         maxValue: 13.5,
         width: 1000,
         timeBlockLength: timeBlockLength, 
         timeBlock: timeBlock,
         chartOptions: chartOptions
      });

      $('#pace').newLineFromSheet({
         color: 'blue',
         id: id, 
         sheet: 'Paces',
         valueColumn: 3,
         scaleOverride: true,
         stepWidth: 1,
         minValue: 2, 
         maxValue: 8,
         timeBlockLength: timeBlockLength, 
         timeBlock: timeBlock,
         chartOptions: chartOptions
      });

      $('#sleep').newLineFromSheet({
         color: 'orange',
         id: id, 
         sheet: 'Sleep',
         scaleOverride: true,
         stepWidth: 50,
         minValue: 100, 
         maxValue: 650,
         timeBlockLength: timeBlockLength, 
         timeBlock: timeBlock,
         chartOptions: chartOptions
      });

      $('#water').newLineFromSheet({
         color: 'blue',
         id: id, 
         sheet: 'Water',
         scaleOverride: true,
         stepWidth: 8,
         minValue: 0, 
         maxValue: 124,
         timeBlockLength: timeBlockLength, 
         timeBlock: timeBlock,
         chartOptions: chartOptions
      });

      $('#carbs').newLineFromSheet({
         color: 'green',
         id: id, 
         sheet: 'Macronutrients',
         sheet2: 'Macronutrients',
         valueColumn: 1,
         valueColumn2: 2,
         scaleOverride: false,
         timeBlockLength: timeBlockLength, 
         timeBlock: timeBlock,
         chartOptions: chartOptions
      });

      $('#protein').newLineFromSheet({
         color: 'blue',
         id: id, 
         sheet: 'Macronutrients',
         valueColumn: 3,
         scaleOverride: true,
         stepWidth: 15,
         minValue: 0, 
         maxValue: 190,
         timeBlockLength: timeBlockLength, 
         timeBlock: timeBlock,
         chartOptions: chartOptions
      });

      $('#calories').newLineFromSheet({
         color: 'purple',
         id: id, 
         sheet: 'Macronutrients',
         valueColumn: 6,
         scaleOverride: true,
         stepWidth: 250,
         minValue: 0, 
         maxValue: 4000,
         timeBlockLength: timeBlockLength, 
         timeBlock: timeBlock,
         chartOptions: chartOptions
      });

      $('#fat').newLineFromSheet({
         color: 'red',
         id: id, 
         sheet: 'Macronutrients',
         sheet2: 'Macronutrients',
         valueColumn: 4,
         valueColumn2: 5,
         scaleOverride: true,
         stepWidth: 15,
         minValue: 0, 
         maxValue: 175,
         timeBlockLength: timeBlockLength, 
         timeBlock: timeBlock,
         chartOptions: chartOptions
      });

      $('#avgMacronutrients').newDoughnutFromSheet({
         id: id,
         sheet: 'avgMacronutrients',
         label1: 'Carbs',
         label2: 'Protein',
         label3: 'Fat',
         valueColumn2: 3,
         valueColumn3: 4,
         timeBlock: timeBlock,
         chartOptions: chartOptions
      });

      $('#avgSleep').newStatFromSheet({
         id: id,
         sheet: 'avgValues',
         valueRow: 1,
         label: 'minutes'
      });

      $('#avgSugar').newStatFromSheet({
         id: id, 
         sheet: 'avgValues',
         valueRow: 2, 
         label: 'grams'
      });

      $('#avgCalories').newStatFromSheet({
         id: id, 
         sheet: 'avgValues',
         valueRow: 3, 
         label: 'KCal'
      });

      $('#avgMileage').newStatFromSheet({
         id: id, 
         sheet: 'avgValues',
         valueRow: 4, 
         label: 'miles'
      });

      $('#avgPace').newStatFromSheet({
         id: id, 
         sheet: 'avgValues',
         valueRow: 5, 
         label: 'min/mile'
      });

      switch(timeBlock) {
         case 0:
            $('.whichWeek').html('This '+state);
            $('.doughnutTime').html('Last week');
            break;
         case 1:
            $('.whichWeek').html('Last '+state);
            $('.doughnutTime').html('2 weeks Ago');
            break;
         default: 
            $('.whichWeek').html(timeBlock +" "+ state +'s Ago');
            $('.doughnutTime').html(timeBlock +' weeks Ago')
      } 

      switch (state) {
         case 'week': 
            if (timeBlock <= 0) {
               $('.forward').hide();
            } else {
               $('.forward').show();
            }
            break;
         case 'month':
            if (timeBlock <= 0) {
               $('.forward').hide();
            } else {
               $('.forward').show();
            }
            break;
      }

   } 
    </script>
</body>
</html>

